<div class="mainForm">
  <form [formGroup]="questionarioFormGroup">
    @if(competences.legth > 0){ 
      <mat-stepper #linearVerticalStepper="matVerticalStepper" [linear]="isLinear" formArrayName="competences" #stepper>

        @for (competence of iterableCompetences; track competence; let i = $index) {
        <mat-step #mat_step [formGroupName]="i" [stepControl]="competences?.get([i])">
          <ng-template matStepLabel>>{{'Q'}}{{ i+1 }}</ng-template>
          <h3>{{competence.descricao}}</h3>
          <ng-container formArrayName="habilidades">
            <div [ngStyle]="{ 'display':'flex', 'flex-direction': 'column'}"
              *ngFor="let habilidade of competence.habilidades; let j = index">
              <span>{{makeSkill(habilidade).question}}</span>
              <mat-form-field [ngClass]="'mat-form-selector'">
                <mat-label>Escolha</mat-label>
                <mat-select [formControlName]="j" required>
                  @for (skill of skillLevelsOptions; track $index) {
                  <mat-option [value]="getSkillLevelsAswerNumberValue(skill)" (onSelectionChange)="test()">
                    {{getSkillLevelsAswer[skill]}}
                  </mat-option>
                  }
                </mat-select>
              </mat-form-field>
            </div>
          </ng-container>
        </mat-step>
        }
        <!-- <mat-step #mat_step *ngFor="let competence of iterableCompetences; let i = index" [formGroupName]="i" [stepControl]="competences?.get([i])">
          <ng-template matStepLabel>>{{'Q'}}{{ i+1 }}</ng-template>
          <h3>{{competence.descricao}}</h3>
          <ng-container formArrayName="habilidades">
            <div [ngStyle]="{ 'display':'flex', 'flex-direction': 'column'}" *ngFor="let habilidade of competence.habilidades; let j = index">
              <span>{{makeSkill(habilidade).question}}</span>
              <mat-form-field [ngClass]="'mat-form-selector'">
                <mat-label>Escolha</mat-label>
                <mat-select  [formControlName]="j" required >
                    <mat-option *ngFor="let skill of skillLevelsOptions" [value]="getSkillLevelsAswerNumberValue(skill)" (onSelectionChange)="test()">
                        {{getSkillLevelsAswer[skill]}}
                    </mat-option>
                </mat-select>
              </mat-form-field>
            </div>
          </ng-container>
        </mat-step> -->
        <mat-step>
          <ng-template matStepLabel>Fim</ng-template>
          Gostaria de enviar o questionário?
          <div>
            <button mat-button matStepperPrevious>Voltar</button>
            <button mat-button (click)="onSubmit(stepper)">Enviar</button>
          </div>
        </mat-step>
      </mat-stepper>
    } @else {
    <h3 class="no-competences">Nenhuma competência encontrada</h3>
  }
  </form>
  <div class="pill-group">
    <a
        class="pill"
        [href]="'https://angular.dev/tools/cli'"
        target="_blank"
        rel="noopener"
          >
            <span>Voltar ao menu</span>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              height="14"
              viewBox="0 -960 960 960"
              width="14"
              fill="currentColor"
            >
              <path
                d="M 480 0 C 214.617188 0 0 214.617188 0 480 C 0 745.382812 214.617188 960 480 960 C 745.382812 960 960 745.382812 960 480 C 960 214.617188 745.382812 0 480 0 Z M 480 896 C 229.78125 896 64 730.21875 64 480 C 64 229.78125 229.78125 64 480 64 C 730.21875 64 896 229.78125 896 480 C 896 730.21875 730.21875 896 480 896 Z M 480 896"
              ></path>
            </svg>
          </a>
    <button mat-button >Voltar ao menu</button>
  </div>

</div>